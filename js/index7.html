<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Searchable Verb Form</title>
  <style>
    /* Basic styling for autocomplete */
    .autocomplete-suggestions {
      border: 1px solid #ccc;
      max-height: 150px;
      overflow-y: auto;
      position: absolute;
      background-color: white;
      z-index: 1000;
    }

    .autocomplete-suggestion {
      padding: 8px;
      cursor: pointer;
    }

    .autocomplete-suggestion:hover {
      background-color: #f0f0f0;
    }

    #verbInput {
      width: 200px;
    }
  </style>
</head>
<body>

<h3>French Verb Lookup & Submit</h3>

<form id="verbForm" onsubmit="handleSubmit(event)">
  <input type="text" id="verbInput" name="verb" placeholder="Type a verb..." autocomplete="off">
  <div id="autocomplete-list" class="autocomplete-suggestions"></div>
<br>
  <label for="translation">Translation:</label>
  <input type="text" id="translation" name="translation" readonly>
<br>
  <label for="similar">Similar Conjugation:</label>
  <input type="text" id="similar" name="similar" readonly>
<br>
  <button id="btnLoadConjugate" onclick="LoadConjugate();" type="button">Submit</button>
</form>

<h1>French Verb Conjugation Viewer</h1>
<div id="output">Loading...</div>

<script>
  const verbData = [
    {
      "verb": "parler",
      "translation": "to speak",
      "Similar Conj.": "Regular ER Verbs.",
      "File Name": "Parler.json"
    },
    {
      "verb": "finir",
      "translation": "to finish",
      "Similar Conj.": "Regular IR Verbs.",
      "File Name": "Finir.json"
    },
    {
      "verb": "vendre",
      "translation": "to sell",
      "Similar Conj.": "Regular RE Verbs.",
      "File Name": "Vendre.json"
    }
  ];

  const input = document.getElementById("verbInput");
  const list = document.getElementById("autocomplete-list");

  input.addEventListener("input", function () {
    const query = this.value.toLowerCase();
    list.innerHTML = "";

    if (!query) return;

    const matches = verbData.filter(item =>
      item.verb.toLowerCase().includes(query) ||
      item.translation.toLowerCase().includes(query) ||
      item["Similar Conj."].toLowerCase().includes(query)
    );

    matches.forEach(item => {
      const div = document.createElement("div");
      div.classList.add("autocomplete-suggestion");
      div.textContent = item.verb + " — " + item.translation;
      div.addEventListener("click", () => {
        input.value = item.verb;
        document.getElementById("translation").value = item.translation;
        document.getElementById("similar").value = item["Similar Conj."];
        list.innerHTML = "";
      });
      list.appendChild(div);
    });
  });

  document.addEventListener("click", function (e) {
    if (!list.contains(e.target) && e.target !== input) {
      list.innerHTML = "";
    }
  });

async function LoadConjugate() {
  alert("LoadConjugate")
  const verb = document.getElementById("verbInput").value.toLowerCase();
  alert(verb)
  const match = verbData.find(item => item.verb.toLowerCase() === verb);
alert(match)

  const output = document.getElementById("output");
  output.innerHTML = "Loading...";
	alert("data");
  if (!match) {
    output.innerHTML = `<p style="color: red;">Verb not found in list.</p>`;
    return;
  }

  try {
    const response = await fetch(match["File Name"]);
    if (!response.ok) throw new Error("Failed to load conjugation file.");
    const data = await response.json();
    renderConjugations(data);
  } catch (err) {
    output.innerHTML = `<p style="color: red;">Error: ${err.message}</p>`;
  }
}


  function handleSubmit(event) {
    event.preventDefault();
    LoadConjugate();
  }

function renderConjugations(data) {
  const output = document.getElementById("output");
  const { verb, translation, conjugations } = data;

  let html = `<h2>${verb} — ${translation}</h2>`;

  for (const [tense, info] of Object.entries(conjugations)) {
    html += `<h3>${formatTenseLabel(tense)}</h3>`;

    if (info.forms) {
      html += `<ul>`;
      for (const [subject, form] of Object.entries(info.forms)) {
        html += `<li><strong>${subject}</strong>: ${form}</li>`;
      }
      html += `</ul>`;
    } else if (info.form) {
      html += `<p><strong>Form:</strong> ${info.form}</p>`;
    }

    if (info.example) {
      html += `<p><em>${info.example.fr}</em><br><small>${info.example.en}</small></p>`;
    } else if (info.present?.example || info.past?.example) {
      if (info.present) {
        html += `<p><strong>Present:</strong> ${info.present.form}</p>`;
        html += `<p><em>${info.present.example.fr}</em><br><small>${info.present.example.en}</small></p>`;
      }
      if (info.past) {
        html += `<p><strong>Past:</strong> ${info.past.form}</p>`;
        html += `<p><em>${info.past.example.fr}</em><br><small>${info.past.example.en}</small></p>`;
      }
    }
  }

  output.innerHTML = html;
}

function formatTenseLabel(tense) {
  return tense
    .replace(/_/g, " ")
    .replace(/\b\w/g, l => l.toUpperCase()); // capitalize words
}

</script>

</body>
</html>
